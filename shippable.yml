language: none
build:
    pre_ci_boot:
        image_name: nsimakov/akrr_ready_centos_slurm_single_host_wlm
        image_tag: 1
        pull: true
        options: "--user root -e HOME=/root -t"
    ci:
        # Start all daemons
        - cmd_start self_contained_slurm_wlm
        - squeue
        - sinfo
        - chmod a+r /etc/slurm/slurm.conf
        - ps -Af
        - cat /var/log/slurm/slurmctld.log
        - cat /var/log/slurm/slurmd.log
        # Run tests
        - export PATH=/root/src/github.com/$REPO_FULL_NAME/bin:/root/src/github.com/$REPO_FULL_NAME/tests/bin:$PATH
        - /root/src/github.com/$REPO_FULL_NAME/tests/regtest1/run_test.sh
